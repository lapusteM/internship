<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=1024" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<title>Session 6 - jQuery animations and plugins</title>

		<link href="http://fonts.googleapis.com/css?family=Open+Sans:regular,semibold,italic,italicsemibold|PT+Sans:400,700,400italic,700italic|PT+Serif:400,700,400italic,700italic" rel="stylesheet" />
		<link href="css/impress-demo.css" rel="stylesheet" />
		<link href="css/desert.css" rel="stylesheet" />
		<link rel="shortcut icon" href="favicon.png" />
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		<script src="js/prettify.js"></script>
		
		<style type="text/css">
		  pre { font-size: 60%; line-height: 22px; font-family: Courier; }
		  p.small { font-size: 70%; }
		  .red { color: crimson; }
		  q.small { margin-top: 50px; }
		  q.smallest { margin-top: 0; }
		</style>
	</head>

	<body class="impress-not-supported">

		<div class="fallback-message">
			<p>Your browser <b>doesn't support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>
			<p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p>
		</div>

		<div id="impress">
			<div class="step slide">
				<q><center>JavaScript Training</center></q>
				<p><center>&mdash; Session 6: Advanced animations and jQuery Plugins &mdash;</center></p>
				<br /><br />
				<p>Topics:</p>
				<p>$. Advanced animations</p>
				<p>$. Working with jQuery plugins</p>
				<p>$. Creating jQuery plugins</p>
				<br />
				<p>Think twice, code once!</p>
				<p class="small">Radu B. Gaspar</p>
			</div>

			<div class="step slide">
				<p><b>Advanced animations</b></p><br />
				<p>When we think about advanced animations, we think complex movements and interactions, that provide a good user experience.</p><br />
				<p>Animations are more than simply moving an object from one location to another... take games for instance, they use the simple concept of <span class="red">user driven animation</span> to create an environment which can provide hours of entertainment.</p><br />
				<p>Although the animations we've talked so far were 2D, we can also <span class="red">tackle the 3rd dimension</span> with a bit of tweaking.</p><br />
				<q class="small"><center><a class="red" href="demos/sphere/index.html" target="_blank">Interactive 3D Demo</a></center></q>
			</div>

			<div class="step slide">
				<p>We can also create complex 2D environments that give the <span class="red">feeling of depth</span>.</p><br />
				<p><span class="red">Parallax scrolling</span> is a special scrolling technique, wherein background images move by the camera slower than foreground images, creating an illusion of depth in a 2D environment.</p><br />
				<p>There are plenty of libraries out there which can handle this effect with ease...</p><br />
				<q class="small"><center><a class="red" href="http://www.createjs.com/#!/EaselJS/demos/spritesheet" target="_blank">EaselJS Demo</a></center></q>
			</div>

			<div class="step slide">
				<p>The <span class="red">more background elements</span> you use, the more intricate the parallax scrolling effect can become.</p><br />
				<p>But games are rearly so simple... a quaint game like Mario requires some sort of collision detection engine to function properly:</p><br />
				<q class="smallest"><center><a class="red" href="demos/html5-mario/index.html" target="_blank">HTML5 Mario Demo</a></center></q><br />
				<p>Combine all of these things: a bit of paralax, a simple collision detection engine, a few enemies and you've got yourself <a class="red" href="http://luxahoy.com/" target="_blank">a game that's fun and interactive</a>.</p><br />
				<p>When it gets down to it, it's just a bunch of advanced, user triggered, animations that are also influenced by de environment.</p>
			</div>

			<div class="step slide">
				<p>All <span class="red">HTML5 Canvas based games</span> use blitting (or bit blit which stands for <span class="red">bit-boundary block transfer</span>) to create smooth and low memory cost animations.</p><br />
				<p>Although this concept is rather old, it's still used in 2D browser games due to its performance. The HTML5 version of <span class="red">Angry Birds</span> is one such example:</p><br />
				<q class="small"><center><a class="red" href="http://chrome.angrybirds.com/" target="_blank">Angry Birds HTML5 Demo</a></center></q><br />
				<p>Simple concept, good quality graphics, simple physics engine and the result is an animation packed fun game.</p><br />
				<p>To create game spritesheets you might want to have a look at <a class="red" href="http://www.codeandweb.com/texturepacker" target="_blank">TexturePacker</a>.</p>
			</div>

			<div class="step slide">
				<p><b>Working with jQuery Plugins</b></p><br />
				<p><span class="red">A jQuery plugin</span> is simply a new method that we use to <span class="red">extend the jQuery prototype object</span>.</p><br />
				<p><b>By extending the prototype object you enable all jQuery objects to inherit any methods that you add.</b></p><br />
				<p>Whenever you call <span class="red">jQuery()</span> you're creating a new jQuery object, with all of jQuery's methods inherited.</p><br />
				<p>The idea of a plugin is to do something with a collection of elements.</p><br />
				<p>You could consider each method that comes with the jQuery core a plugin, like <span class="red">.fadeOut()</span> or <span class="red">.addClass()</span>.</p>
			</div>

			<div class="step slide">
				<p>You can <span class="red">make your own plugins</span> and use them privately in your code or you can release them into the wild.</p><br />
				<p>There are <span class="red">thousands</span> of jQuery plugins available online.</p><br />
				<p><b>All jQuery plugins require that jQuery is loaded and ready!</b> Since jQuery is the <span class="red">core</span>, it's a jQuery plugin's only dependency.</p><br />
<pre class="prettyprint lang-html">
...
&lt;head&gt;
    &lt;script type="text/javascript" src="js/jquery.min.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="js/jquery.prime.js"&gt;&lt;/script&gt;
&lt;/head&gt;
...
</pre><br />
				<p>It's <span class="red">not required</span> that these script tags be in the head and the common pattern is to prefix any jQuery plugin name with <span class="red">jquery</span>. In our case, <span class="red">jquery.prime.js</span>, is the jQuery plugin, and it's loaded <b>after jQuery, this is required!</b></p>
			</div>

			<div class="step slide">
				<p>Let's see the <span class="red">jQuery Prime</span> plugin in action:</p>
				<q class="small"><center><a class="red" href="demos/plugin-prime/index.html" target="_blank">jQuery Plugin Demo</a></center></q><br />
				<p>Out simple jQuery plugin will take any number smaller than <span class="red">100 000</span> and check if it's a prime.</p><br />
				<p>The result of that check will be displayed in an input field; the plugin is used thusly:</p><br />
<pre class="prettyprint lang-js">
$("form").on("submit", function() {
    // check if prime
    $("#result").prime({
        number: $("#number").val()
    });

    return false;
});
</pre>
			</div>

			<div class="step slide">
				<p>Our plugin <span class="red">assumes that the result will be displayed in an input</span> tag.</p><br />
				<p>The best plugins are the ones that work without making assumptions on the (or requiring specific) DOM constructs.</p><br />
				<p>This is an easily fixable problem. The <span class="red">process</span> of creating a jQuery plugin is an <span class="red">easy</span> one with just a few basic rules.</p><br />
				<p><b>The question is what do you need?</b><br />
				&nbsp;&nbsp;&nbsp;-&nbsp;A plugin which requires a specific DOM structure,<br />
				&nbsp;&nbsp;&nbsp;-&nbsp;A plugin which will create a DOM structure for you <b>or</b><br />
				&nbsp;&nbsp;&nbsp;-&nbsp;A plugin which allows you to specify a template.</p><br />
				<p>All of the above are <span class="red">valid approaches</span> and are commonly asked questions when creating jQuery plugins that work with the UI.</p>
			</div>

			<div class="step slide">
				<p><b>Creating jQuery plugins</b></p><br />
				<p><b>Basic Plugin Authoring</b></p>
				<p>Let's say we want to create a plugin that makes text within a set of retrieved elements blue. All we have to do is add a function called <span class="red">makeBlue</span> to <span class="red">$.fn</span> and it will be available just like any other jQuery object method.</p><br />
<pre class="prettyprint lang-js">
$.fn.makeBlue = function() {
    this.css("color", "blue");
};
 
$("li").makeBlue(); // makes all the li tags blue
</pre><br />
				<p><b>Chaining</b></p>
				<p>The example above works, but we're breaking the jQuery chaining feature. To fix this, we need to return the original jQuery object.</p>
			</div>

			<div class="step slide">
				<p>Returning the original jQuery object is a simple task, we just need to add one line of code to our plugin:</p><br />
<pre class="prettyprint lang-js">
$.fn.makeBlue = function() {
    this.css("color", "blue");
    return this; // return the original jQuery object
};
 
$("li").makeBlue(); // makes all the li tags blue
</pre><br />
				<p><b>Protecting the $ Alias and Adding Scope</b></p>
				<p>We might have another JavaScript library that defines the <span class="red">$</span> variable as something else; this will break our plugin since it is written with the assumption that <span class="red">$</span> is an alias to the jQuery function.</p><br />
				<p>The easiest way to fix this is to wrap our plugin within a SEAF (IIFE). Another added bonus of this is that it will allow us to have our own private variables.</p>
			</div>

			<div class="step slide">
				<p>Let's fix our plugin</p><br />
<pre class="prettyprint lang-js">
(function($) {
    $.fn.makeBlue = function() {
        this.css("color", "blue");
        return this; // return the original jQuery object
    };
}(jQuery));
 
$("li").makeBlue(); // makes all the li tags blue
</pre><br />
				<p>That's better... how about a different shade of blue?</p><br />
<pre class="prettyprint lang-js">
(function($) {
    var darkBlue = "#0673ab";

    $.fn.makeBlue = function() {
        this.css("color", darkBlue);
        return this; // return the original jQuery object
    };
}(jQuery));
 
$("li").makeBlue(); // makes all the li tags blue
</pre>
			</div>

			<div class="step slide">
				<p><b>Minimizing Plugin Footprint</b></p><br />
				<p>It's good practice when writing plugins to only take up one slot within <span class="red">$.fn</span>. This <span class="red">reduces</span> both the <span class="red">chance that your plugin will be overridden</span>, and the <span class="red">chance that your plugin will override other plugins</span>.</p><br />
<pre class="prettyprint lang-js">
// this is bad
(function($) {
    $.fn.openPopup = function() { /*...*/ };
    $.fn.closePopup = function() { /*...*/ };
}(jQuery));

// this is much better
(function($) {
    $.fn.popup = function(action) {
        if (action === "open") { /*...*/ }
        if (action === "close") { /*...*/ }
    };
}(jQuery));
</pre>
			</div>

			<div class="step slide">
				<p><b>Using the <span class="red">each()</span> method</b></p><br />
				<p>Your typical jQuery object will contain <span class="red">references to any number of DOM elements</span>, and that's why jQuery objects are often referred to as <span class="red">collections</span>.</p><br />
				<p>If you want to do any <span class="red">manipulating with specific elements</span> (e.g. getting a data attribute, calculating specific positions) then <span class="red">you need to use .each()</span> to loop through the elements.</p>
<pre class="prettyprint lang-js">
$.fn.amazingNewPlugin = function() {

    return this.each(function() {
        // do something to each element here
    });

};
</pre><br />
				<p>Since <span class="red">.each() is already chainable, it returns this</span>, which we then return. This is a better way to maintain chainability than what we've been doing so far.</p>
			</div>

			<div class="step slide">
				<p><b>Accepting Options</b></p>
				<p>As your plugins get more and more complex, it's a good idea to <span class="red">make your plugin customizable</span> by accepting options.</p><br />
				<p>The <span class="red">easiest way</span> do this, especially if there are lots of options, is with an <span class="red">object literal</span>.</p><br />
<pre class="prettyprint lang-js">
(function($) {
    $.fn.makeBlue = function(options) {
        // default options
        var settings = $.extend({
            color: "#0673ab",
            backgroundColor: "white"
        }, options);

        // change the collection color based on the settings variable
        return this.css({
            color: settings.color,
            backgroundColor: settings.backgroundColor
        });
    };
}(jQuery));
</pre>
			</div>

			<div class="step slide">
				<p><b>How do you use it now?</b> Like this:</p><br />
<pre class="prettyprint lang-js">
$("div").makeBlue({
    color: "magenta"
});
</pre><br />
				<p>The default value for color of <span class="red">#0673ab</span> gets overridden by $.extend() to be <span class="red">magenta</span>.</p><br />
				<p>The process couldn't be easier, and <span class="red">these basics apply to all jQuery plugins</span> regardless of their complexity or size. Let's see some examples:</p><br />
				<p><center><a class="red" href="demos/plugins/html/colorPickers.html" target="_blank">SVG Color Picker</a></center></p>
				<p><center><a class="red" href="demos/plugins/html/detectQuirksMode.html" target="_blank">Detect Quirks Mode</a></center></p>
				<p><center><a class="red" href="demos/plugins/html/randomColors.html" target="_blank">Random Colors</a></center></p>
				<p><center><a class="red" href="demos/plugins/html/textHighlighter.html" target="_blank">Text Highlighter</a></center></p>
			</div>

			<div class="step slide">
				<p><b>Advanced Plugin Concepts</b></p><br />
				<p>An improvement we can, <span class="red">and should</span>, make to the code above is to expose the default plugin settings. This is important because it makes it <span class="red">very easy</span> for plugin users <span class="red">to override/customize the plugin</span> with minimal code.</p>
<pre class="prettyprint lang-js">
(function($) {
    $.fn.makeBlue = function(options) {
        // extend default options
        var opts = $.extend({}, $.fn.makeBlue.defaults, options);

        // change the collection color based on the settings variable
        return this.css({
            color: opts.color,
            backgroundColor: opts.backgroundColor
        });
    };

    // plugin defaults added as a property on our plugin function
    $.fn.makeBlue.defaults = {
        color: "#0673ab",
        backgroundColor: "white"
    };
}(jQuery));
</pre>
			</div>

			<div class="step slide">
				<p><b>Why is this helpful?</b> Because developers can now include a line like this in their code:</p><br />
<pre class="prettyprint lang-js">
// This needs only be called once and does not
// have to be called from within a "ready" block
$.fn.makeBlue.defaults.color = "red";

// now we can call the plugin method like this
// and it will use a red color
$("#someDiv").makeBlue();
</pre><br />
				<p>We can change any or all of the default options in this manner.</p><br />
				<p>This can be viewed as an extra layer of plugin customization and, based on the plugin you're creating, a <span class="red">must have feature</span>.</p>
			</div>

			<div class="step slide">
				<p><b>Provide public access to secondary functions as needed</b></p><br />
				<p>In the same fashion as we defined a defaults variable we can, in fact, define methods which the plugin will the later use as needed.</p><br />
<pre class="prettyprint lang-js">
// hilight plugin
$.fn.hilight = function(options) {
    // iterate and reformat each matched element.
    return this.each(function() {
        var $this = $(this);
        var markup = $this.html();
 
        // call our format function.
        markup = $.fn.hilight.format(markup);
        $this.html(markup);
    });
};
 
// Define our format function.
$.fn.hilight.format = function(str) {
    return "&lt;strong&gt;" + str + "&lt;/strong&gt;";
};
</pre><br />
			</div>

			<div class="step slide">
				<p><b>Anything else?</b> Yes, just a few more tips:</p><br />
				<p>1. Keep the plugin <span class="red">private functions private</span>.</p>
<pre class="prettyprint lang-js">
// create closure
(function($) {
    // plugin definition.
    $.fn.hilight = function(options) {
        debug(this);
        // ...
    };
 
    // private function for debugging.
    function debug($obj) {
        if (window.console &amp;&amp; window.console.log) {
            window.console.log("hilight selection count: " + $obj.size());
        }
    };
    // ...
// end of closure.
}(jQuery));
</pre><br />
				<p>2. Don't Create Plugin-specific Syntax</p>
				<p>3. Give Full Control of Elements</p>
			</div>

			<div class="step slide">
				<p>4. Provide Callback Capabilities</p><br />
<pre class="prettyprint lang-js">
// ...
var defaults = {
    // we define an empty anonymous function so that
    // we don't need to check its existence before calling it.
    onImageShow : function() {},
    // other settings here
};
 
// later on in the plugin:
$nextButton.on("click", showNextImage);
 
function showNextImage() {
    // doing stuff to show the next image
 
    // here's the callback:
    settings.onImageShow.call(this);
}
// ...
</pre><br />
				<p><center><a class="red" href="http://plugins.jquery.com/" target="_blank">Check out the jQuery Plugins site</a></center></p>
			</div>

			<div class="step slide">
				<q><center>JavaScript Training</center></q>
				<p><center>&mdash; Session 6: jQuery animations and plugins &mdash;</center></p>
				<q><center>Thank You!</center></q>
			</div>

			<div class="step slide">
				<q><center>Session 7: $.UI &amp; Desing Patterns</center></q>
				<p><center>Next <span class="red">Monday, 2/December/2013</span></center></p>
				<p><center>from <span class="red">9-10</span> and <span class="red">17-18</span></center></p>
			</div>
		</div>
		<script src="js/impress.js"></script>
		<script src="js/scripts.js"></script>
	</body>
</html>	